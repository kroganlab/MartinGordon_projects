"0","counts.mat <- dcast(counts.dt, sgRNA~paste0(group, '.', replicate), value.var = 'counts') %>% "
"0","  as.matrix(rownames = 1)"
"0",""
"0","sigHits <- clean.dt[contrast == 'High_CARD9-Low_CARD9' & sig != 'not', id]"
"0","apHits <- clean.dt[contrast == 'High_CARD9-Low_CARD9' & lab == 'APelin hit', id]"
"0",""
"0","guides.oi <- counts.dt[gene %in% c(sigHits, apHits), sgRNA]"
"0","# subset to guides belonging to sig list"
"0",""
"0","submat <- counts.mat[rownames(counts.mat) %in% guides.oi,]"
"0","submat <- log2(submat +1)"
"0",""
"0","# sweep out the median values and lets see how these two things change; lets see if our hits look decent quality"
"0","#submat <- sweep(submat, 1, apply(submat, 1, median, na.rm=T))"
"0",""
"0","hm <- Heatmap(submat, "
"0","        col=viridis(100), "
"0","        name='log2(counts+1)',"
"0","        column_split = gsub('.[12]$' ,'', colnames(submat)), "
"0","        border=T,"
"0","        column_names_gp = gpar(fontsize=6),"
"0","        show_row_names=F)"
"0","hm"
